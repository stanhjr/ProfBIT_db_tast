# ProfBIT_db_tast

## custom manage commands

**generating_fake_db**

генерация товарной номенклатуры
команда принимает два аргумента {количество категорий} {количество товаров в категории}

**example**  
python manage.py generating_fake_db 5 50


**update_fake_db**

команда для изменения цены, статуса, остатков по товарам
при запуске команды, рандомно устанавливает цену товара (price), статус (status), остатки (remains) для всех товаров в базе

**example**  
python manage.py update_fake_db

## project description

**url_example**

*category/<int:pk>/*     pk = category_id

http://127.0.0.1:8000/category/1/

В вью присутствует:

паггинация по 50 товаров на странице

кэширование каждой из страниц *FileBasedCache*

time.sleep(2) для иммитации сложных вычислений

**при обновлении товаров кэш уничтожается (переопределён метод save() модели Product)**


## Cache algoritm description
Механизм частичного обновления кэша предлагаю организовать следующим образом

- Кэш хранить в redis, для быстрого доступа к нему
- данные в redis хранить в виде хэш таблиц, благо redis позволяет

В итоге мы получим структуру близкую к такой (детально не описываю структуру redis)

page_id : {

    category_id :{
    
         product_id: {
         
             product_status: "tea",
             
             product_price: "123.43",
             
             product_remains: "2"
             
}}}

Механизм отслеживания изменённых данных реализован в **ModelDiffMixin**, результаты изменений на данный момент выводятся в консоль, в будущем эти данные должны быть помещены в кэш

при обновлении модели продукта, идём в кэш и если id продукта там есть, то перезаписываем по ключу продукта изменённые данные











